<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.9.1">
  <compounddef id="stormnode-sync_8cpp" kind="file" language="C++">
    <compoundname>stormnode-sync.cpp</compoundname>
    <includes refid="stormnode-sync_8h" local="yes">stormnode-sync.h</includes>
    <includes refid="activestormnode_8h" local="yes">activestormnode.h</includes>
    <includes refid="stormnode-budget_8h" local="yes">stormnode-budget.h</includes>
    <includes refid="stormnode-payments_8h" local="yes">stormnode-payments.h</includes>
    <includes refid="stormnode_8h" local="yes">stormnode.h</includes>
    <includes refid="stormnodeman_8h" local="yes">stormnodeman.h</includes>
    <includes refid="spork_8h" local="yes">spork.h</includes>
    <includes refid="util_8h" local="yes">util.h</includes>
    <includes refid="addrman_8h" local="yes">addrman.h</includes>
    <incdepgraph>
      <node id="24509">
        <label>list</label>
      </node>
      <node id="24463">
        <label>boost/thread/mutex.hpp</label>
      </node>
      <node id="24543">
        <label>leveldb/write_batch.h</label>
        <link refid="write__batch_8h"/>
        <childnode refid="24462" relation="include">
        </childnode>
        <childnode refid="24541" relation="include">
        </childnode>
      </node>
      <node id="24557">
        <label>netinet/in.h</label>
      </node>
      <node id="24495">
        <label>amount.h</label>
        <link refid="amount_8h"/>
        <childnode refid="24476" relation="include">
        </childnode>
        <childnode refid="24460" relation="include">
        </childnode>
        <childnode refid="24462" relation="include">
        </childnode>
      </node>
      <node id="24550">
        <label>arpa/inet.h</label>
      </node>
      <node id="24527">
        <label>boost/thread/condition_variable.hpp</label>
      </node>
      <node id="24479">
        <label>limits</label>
      </node>
      <node id="24580">
        <label>init.h</label>
        <link refid="init_8h"/>
      </node>
      <node id="24488">
        <label>crypto/sha256.h</label>
        <link refid="sha256_8h"/>
        <childnode refid="24474" relation="include">
        </childnode>
        <childnode refid="24460" relation="include">
        </childnode>
      </node>
      <node id="24579">
        <label>stormnode-budget.h</label>
        <link refid="stormnode-budget_8h"/>
        <childnode refid="24492" relation="include">
        </childnode>
        <childnode refid="24525" relation="include">
        </childnode>
        <childnode refid="24546" relation="include">
        </childnode>
        <childnode refid="24457" relation="include">
        </childnode>
        <childnode refid="24502" relation="include">
        </childnode>
        <childnode refid="24568" relation="include">
        </childnode>
        <childnode refid="24567" relation="include">
        </childnode>
        <childnode refid="24569" relation="include">
        </childnode>
        <childnode refid="24580" relation="include">
        </childnode>
      </node>
      <node id="24494">
        <label>primitives/transaction.h</label>
        <link refid="transaction_8h"/>
        <childnode refid="24495" relation="include">
        </childnode>
        <childnode refid="24470" relation="include">
        </childnode>
        <childnode refid="24476" relation="include">
        </childnode>
        <childnode refid="24496" relation="include">
        </childnode>
        <childnode refid="24497" relation="include">
        </childnode>
        <childnode refid="24524" relation="include">
        </childnode>
        <childnode refid="24522" relation="include">
        </childnode>
      </node>
      <node id="24489">
        <label>crypto/argon2/blake2/blake2.h</label>
        <link refid="blake2_8h"/>
        <childnode refid="24490" relation="include">
        </childnode>
        <childnode refid="24474" relation="include">
        </childnode>
        <childnode refid="24466" relation="include">
        </childnode>
      </node>
      <node id="24497">
        <label>script.h</label>
        <link refid="script_8h"/>
        <childnode refid="24462" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
        <childnode refid="24474" relation="include">
        </childnode>
        <childnode refid="24498" relation="include">
        </childnode>
        <childnode refid="24499" relation="include">
        </childnode>
        <childnode refid="24468" relation="include">
        </childnode>
        <childnode refid="24500" relation="include">
        </childnode>
        <childnode refid="24502" relation="include">
        </childnode>
        <childnode refid="24521" relation="include">
        </childnode>
      </node>
      <node id="24520">
        <label>openssl/rand.h</label>
      </node>
      <node id="24572">
        <label>walletdb.h</label>
        <link refid="walletdb_8h"/>
        <childnode refid="24573" relation="include">
        </childnode>
        <childnode refid="24575" relation="include">
        </childnode>
        <childnode refid="24521" relation="include">
        </childnode>
        <childnode refid="24495" relation="include">
        </childnode>
        <childnode refid="24509" relation="include">
        </childnode>
        <childnode refid="24462" relation="include">
        </childnode>
        <childnode refid="24510" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
      </node>
      <node id="24482">
        <label>boost/tuple/tuple.hpp</label>
      </node>
      <node id="24471">
        <label>assert.h</label>
      </node>
      <node id="24556">
        <label>net/if.h</label>
      </node>
      <node id="24583">
        <label>sandstorm.h</label>
        <link refid="sandstorm_8h"/>
        <childnode refid="24525" relation="include">
        </childnode>
        <childnode refid="24570" relation="include">
        </childnode>
        <childnode refid="24581" relation="include">
        </childnode>
      </node>
      <node id="24493">
        <label>txmempool.h</label>
        <link refid="txmempool_8h"/>
        <childnode refid="24494" relation="include">
        </childnode>
        <childnode refid="24525" relation="include">
        </childnode>
        <childnode refid="24530" relation="include">
        </childnode>
        <childnode refid="24495" relation="include">
        </childnode>
        <childnode refid="24545" relation="include">
        </childnode>
      </node>
      <node id="24455">
        <label>stormnode-sync.h</label>
        <link refid="stormnode-sync_8h"/>
        <childnode refid="24456" relation="include">
        </childnode>
        <childnode refid="24492" relation="include">
        </childnode>
      </node>
      <node id="24569">
        <label>boost/lexical_cast.hpp</label>
      </node>
      <node id="24542">
        <label>leveldb/options.h</label>
        <link refid="options_8h"/>
        <childnode refid="24490" relation="include">
        </childnode>
      </node>
      <node id="24529">
        <label>boost/thread/recursive_mutex.hpp</label>
      </node>
      <node id="24568">
        <label>base58.h</label>
        <link refid="base58_8h"/>
        <childnode refid="24562" relation="include">
        </childnode>
        <childnode refid="24468" relation="include">
        </childnode>
        <childnode refid="24457" relation="include">
        </childnode>
        <childnode refid="24497" relation="include">
        </childnode>
        <childnode refid="24458" relation="include">
        </childnode>
        <childnode refid="24462" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
      </node>
      <node id="24483">
        <label>version.h</label>
        <link refid="version_8h"/>
        <childnode refid="24484" relation="include">
        </childnode>
        <childnode refid="24462" relation="include">
        </childnode>
      </node>
      <node id="24530">
        <label>coins.h</label>
        <link refid="coins_8h"/>
        <childnode refid="24531" relation="include">
        </childnode>
        <childnode refid="24493" relation="include">
        </childnode>
        <childnode refid="24471" relation="include">
        </childnode>
        <childnode refid="24474" relation="include">
        </childnode>
        <childnode refid="24498" relation="include">
        </childnode>
        <childnode refid="24544" relation="include">
        </childnode>
      </node>
      <node id="24465">
        <label>sys/mman.h</label>
      </node>
      <node id="24460">
        <label>stdlib.h</label>
      </node>
      <node id="24564">
        <label>chain.h</label>
        <link refid="chain_8h"/>
        <childnode refid="24565" relation="include">
        </childnode>
        <childnode refid="24502" relation="include">
        </childnode>
        <childnode refid="24562" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
        <childnode refid="24498" relation="include">
        </childnode>
      </node>
      <node id="24498">
        <label>boost/foreach.hpp</label>
      </node>
      <node id="24519">
        <label>openssl/crypto.h</label>
      </node>
      <node id="24456">
        <label>stormnode-payments.h</label>
        <link refid="stormnode-payments_8h"/>
        <childnode refid="24457" relation="include">
        </childnode>
        <childnode refid="24492" relation="include">
        </childnode>
        <childnode refid="24567" relation="include">
        </childnode>
        <childnode refid="24569" relation="include">
        </childnode>
      </node>
      <node id="24553">
        <label>compat.h</label>
        <link refid="compat_8h"/>
        <childnode refid="24554" relation="include">
        </childnode>
        <childnode refid="24465" relation="include">
        </childnode>
        <childnode refid="24555" relation="include">
        </childnode>
        <childnode refid="24503" relation="include">
        </childnode>
        <childnode refid="24556" relation="include">
        </childnode>
        <childnode refid="24557" relation="include">
        </childnode>
        <childnode refid="24550" relation="include">
        </childnode>
        <childnode refid="24558" relation="include">
        </childnode>
        <childnode refid="24466" relation="include">
        </childnode>
        <childnode refid="24559" relation="include">
        </childnode>
        <childnode refid="24467" relation="include">
        </childnode>
        <childnode refid="24560" relation="include">
        </childnode>
      </node>
      <node id="24515">
        <label>boost/date_time/posix_time/posix_time_types.hpp</label>
      </node>
      <node id="24485">
        <label>openssl/sha.h</label>
      </node>
      <node id="24560">
        <label>errno.h</label>
      </node>
      <node id="24478">
        <label>cassert</label>
      </node>
      <node id="24473">
        <label>stdexcept</label>
      </node>
      <node id="24502">
        <label>util.h</label>
        <link refid="util_8h"/>
        <childnode refid="24503" relation="include">
        </childnode>
        <childnode refid="24504" relation="include">
        </childnode>
        <childnode refid="24505" relation="include">
        </childnode>
        <childnode refid="24476" relation="include">
        </childnode>
        <childnode refid="24506" relation="include">
        </childnode>
        <childnode refid="24495" relation="include">
        </childnode>
        <childnode refid="24464" relation="include">
        </childnode>
        <childnode refid="24509" relation="include">
        </childnode>
        <childnode refid="24510" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
        <childnode refid="24462" relation="include">
        </childnode>
        <childnode refid="24511" relation="include">
        </childnode>
        <childnode refid="24512" relation="include">
        </childnode>
        <childnode refid="24513" relation="include">
        </childnode>
        <childnode refid="24514" relation="include">
        </childnode>
        <childnode refid="24515" relation="include">
        </childnode>
        <childnode refid="24516" relation="include">
        </childnode>
        <childnode refid="24517" relation="include">
        </childnode>
        <childnode refid="24518" relation="include">
        </childnode>
        <childnode refid="24519" relation="include">
        </childnode>
        <childnode refid="24520" relation="include">
        </childnode>
        <childnode refid="24501" relation="include">
        </childnode>
        <childnode refid="24474" relation="include">
        </childnode>
      </node>
      <node id="24561">
        <label>protocol.h</label>
        <link refid="protocol_8h"/>
        <childnode refid="24562" relation="include">
        </childnode>
        <childnode refid="24476" relation="include">
        </childnode>
        <childnode refid="24552" relation="include">
        </childnode>
        <childnode refid="24474" relation="include">
        </childnode>
        <childnode refid="24462" relation="include">
        </childnode>
      </node>
      <node id="24514">
        <label>boost/date_time/gregorian/gregorian_types.hpp</label>
      </node>
      <node id="24538">
        <label>leveldb/db.h</label>
        <link refid="leveldb_2include_2leveldb_2db_8h"/>
        <childnode refid="24474" relation="include">
        </childnode>
        <childnode refid="24522" relation="include">
        </childnode>
        <childnode refid="24539" relation="include">
        </childnode>
        <childnode refid="24542" relation="include">
        </childnode>
      </node>
      <node id="24462">
        <label>string</label>
      </node>
      <node id="24571">
        <label>wallet.h</label>
        <link refid="wallet_8h"/>
        <childnode refid="24572" relation="include">
        </childnode>
        <childnode refid="24462" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
        <childnode refid="24460" relation="include">
        </childnode>
        <childnode refid="24565" relation="include">
        </childnode>
        <childnode refid="24494" relation="include">
        </childnode>
        <childnode refid="24576" relation="include">
        </childnode>
        <childnode refid="24492" relation="include">
        </childnode>
        <childnode refid="24457" relation="include">
        </childnode>
        <childnode refid="24575" relation="include">
        </childnode>
        <childnode refid="24497" relation="include">
        </childnode>
        <childnode refid="24577" relation="include">
        </childnode>
        <childnode refid="24502" relation="include">
        </childnode>
        <childnode refid="24521" relation="include">
        </childnode>
      </node>
      <node id="24566">
        <label>scrypt.h</label>
        <link refid="scrypt_8h"/>
        <childnode refid="24474" relation="include">
        </childnode>
        <childnode refid="24460" relation="include">
        </childnode>
        <childnode refid="24502" relation="include">
        </childnode>
        <childnode refid="24546" relation="include">
        </childnode>
      </node>
      <node id="24464">
        <label>map</label>
      </node>
      <node id="24511">
        <label>boost/thread.hpp</label>
      </node>
      <node id="24454">
        <label>/home/dev/ds-160209/src/stormnode-sync.cpp</label>
        <link refid="stormnode-sync.cpp"/>
        <childnode refid="24455" relation="include">
        </childnode>
        <childnode refid="24570" relation="include">
        </childnode>
        <childnode refid="24579" relation="include">
        </childnode>
        <childnode refid="24456" relation="include">
        </childnode>
        <childnode refid="24567" relation="include">
        </childnode>
        <childnode refid="24581" relation="include">
        </childnode>
        <childnode refid="24582" relation="include">
        </childnode>
        <childnode refid="24502" relation="include">
        </childnode>
        <childnode refid="24563" relation="include">
        </childnode>
      </node>
      <node id="24563">
        <label>addrman.h</label>
        <link refid="addrman_8h"/>
        <childnode refid="24552" relation="include">
        </childnode>
        <childnode refid="24561" relation="include">
        </childnode>
        <childnode refid="24525" relation="include">
        </childnode>
        <childnode refid="24524" relation="include">
        </childnode>
        <childnode refid="24502" relation="include">
        </childnode>
        <childnode refid="24464" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
      </node>
      <node id="24567">
        <label>stormnode.h</label>
        <link refid="stormnode_8h"/>
        <childnode refid="24525" relation="include">
        </childnode>
        <childnode refid="24546" relation="include">
        </childnode>
        <childnode refid="24457" relation="include">
        </childnode>
        <childnode refid="24502" relation="include">
        </childnode>
        <childnode refid="24568" relation="include">
        </childnode>
        <childnode refid="24492" relation="include">
        </childnode>
        <childnode refid="24524" relation="include">
        </childnode>
      </node>
      <node id="24577">
        <label>ui_interface.h</label>
        <link refid="ui__interface_8h"/>
        <childnode refid="24495" relation="include">
        </childnode>
        <childnode refid="24578" relation="include">
        </childnode>
        <childnode refid="24549" relation="include">
        </childnode>
        <childnode refid="24462" relation="include">
        </childnode>
        <childnode refid="24474" relation="include">
        </childnode>
      </node>
      <node id="24534">
        <label>leveldbwrapper.h</label>
        <link refid="leveldbwrapper_8h"/>
        <childnode refid="24476" relation="include">
        </childnode>
        <childnode refid="24535" relation="include">
        </childnode>
        <childnode refid="24502" relation="include">
        </childnode>
        <childnode refid="24513" relation="include">
        </childnode>
        <childnode refid="24538" relation="include">
        </childnode>
        <childnode refid="24543" relation="include">
        </childnode>
      </node>
      <node id="24490">
        <label>stddef.h</label>
      </node>
      <node id="24499">
        <label>boost/variant.hpp</label>
      </node>
      <node id="24559">
        <label>netdb.h</label>
      </node>
      <node id="24554">
        <label>sys/fcntl.h</label>
      </node>
      <node id="24531">
        <label>undo.h</label>
        <link refid="undo_8h"/>
        <childnode refid="24532" relation="include">
        </childnode>
      </node>
      <node id="24541">
        <label>leveldb/status.h</label>
        <link refid="status_8h"/>
        <childnode refid="24462" relation="include">
        </childnode>
        <childnode refid="24540" relation="include">
        </childnode>
      </node>
      <node id="24545">
        <label>boost/circular_buffer.hpp</label>
      </node>
      <node id="24476">
        <label>serialize.h</label>
        <link refid="serialize_8h"/>
        <childnode refid="24462" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
        <childnode refid="24464" relation="include">
        </childnode>
        <childnode refid="24477" relation="include">
        </childnode>
        <childnode refid="24478" relation="include">
        </childnode>
        <childnode refid="24479" relation="include">
        </childnode>
        <childnode refid="24474" relation="include">
        </childnode>
        <childnode refid="24472" relation="include">
        </childnode>
        <childnode refid="24480" relation="include">
        </childnode>
        <childnode refid="24481" relation="include">
        </childnode>
        <childnode refid="24482" relation="include">
        </childnode>
        <childnode refid="24458" relation="include">
        </childnode>
        <childnode refid="24483" relation="include">
        </childnode>
      </node>
      <node id="24466">
        <label>limits.h</label>
      </node>
      <node id="24526">
        <label>threadsafety.h</label>
        <link refid="threadsafety_8h"/>
      </node>
      <node id="24551">
        <label>mruset.h</label>
        <link refid="mruset_8h"/>
        <childnode refid="24477" relation="include">
        </childnode>
        <childnode refid="24547" relation="include">
        </childnode>
      </node>
      <node id="24505">
        <label>sys/resource.h</label>
      </node>
      <node id="24516">
        <label>openssl/bio.h</label>
      </node>
      <node id="24576">
        <label>crypter.h</label>
        <link refid="crypter_8h"/>
        <childnode refid="24458" relation="include">
        </childnode>
        <childnode refid="24476" relation="include">
        </childnode>
        <childnode refid="24575" relation="include">
        </childnode>
      </node>
      <node id="24549">
        <label>boost/signals2/signal.hpp</label>
      </node>
      <node id="24552">
        <label>netbase.h</label>
        <link refid="netbase_8h"/>
        <childnode refid="24462" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
        <childnode refid="24476" relation="include">
        </childnode>
        <childnode refid="24553" relation="include">
        </childnode>
      </node>
      <node id="24575">
        <label>keystore.h</label>
        <link refid="keystore_8h"/>
        <childnode refid="24457" relation="include">
        </childnode>
        <childnode refid="24468" relation="include">
        </childnode>
        <childnode refid="24525" relation="include">
        </childnode>
        <childnode refid="24497" relation="include">
        </childnode>
        <childnode refid="24549" relation="include">
        </childnode>
        <childnode refid="24499" relation="include">
        </childnode>
      </node>
      <node id="24469">
        <label>hash.h</label>
        <link refid="hash_8h"/>
        <childnode refid="24470" relation="include">
        </childnode>
        <childnode refid="24476" relation="include">
        </childnode>
        <childnode refid="24485" relation="include">
        </childnode>
        <childnode refid="24486" relation="include">
        </childnode>
        <childnode refid="24487" relation="include">
        </childnode>
        <childnode refid="24488" relation="include">
        </childnode>
        <childnode refid="24489" relation="include">
        </childnode>
        <childnode refid="24491" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
      </node>
      <node id="24558">
        <label>ifaddrs.h</label>
      </node>
      <node id="24521">
        <label>stealth.h</label>
        <link refid="stealth_8h"/>
        <childnode refid="24502" relation="include">
        </childnode>
        <childnode refid="24476" relation="include">
        </childnode>
        <childnode refid="24460" relation="include">
        </childnode>
        <childnode refid="24522" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
        <childnode refid="24523" relation="include">
        </childnode>
      </node>
      <node id="24503">
        <label>sys/types.h</label>
      </node>
      <node id="24537">
        <label>ios</label>
      </node>
      <node id="24461">
        <label>string.h</label>
      </node>
      <node id="24484">
        <label>clientversion.h</label>
        <link refid="clientversion_8h"/>
      </node>
      <node id="24480">
        <label>cstdio</label>
      </node>
      <node id="24528">
        <label>boost/thread/locks.hpp</label>
      </node>
      <node id="24518">
        <label>openssl/buffer.h</label>
      </node>
      <node id="24481">
        <label>boost/type_traits/is_fundamental.hpp</label>
      </node>
      <node id="24492">
        <label>main.h</label>
        <link refid="main_8h"/>
        <childnode refid="24493" relation="include">
        </childnode>
        <childnode refid="24546" relation="include">
        </childnode>
        <childnode refid="24497" relation="include">
        </childnode>
        <childnode refid="24535" relation="include">
        </childnode>
        <childnode refid="24533" relation="include">
        </childnode>
        <childnode refid="24564" relation="include">
        </childnode>
        <childnode refid="24509" relation="include">
        </childnode>
        <childnode refid="24544" relation="include">
        </childnode>
      </node>
      <node id="24513">
        <label>boost/filesystem/path.hpp</label>
      </node>
      <node id="24581">
        <label>stormnodeman.h</label>
        <link refid="stormnodeman_8h"/>
        <childnode refid="24525" relation="include">
        </childnode>
        <childnode refid="24546" relation="include">
        </childnode>
        <childnode refid="24457" relation="include">
        </childnode>
        <childnode refid="24502" relation="include">
        </childnode>
        <childnode refid="24568" relation="include">
        </childnode>
        <childnode refid="24492" relation="include">
        </childnode>
        <childnode refid="24567" relation="include">
        </childnode>
      </node>
      <node id="24544">
        <label>boost/unordered_map.hpp</label>
      </node>
      <node id="24468">
        <label>pubkey.h</label>
        <link refid="pubkey_8h"/>
        <childnode refid="24469" relation="include">
        </childnode>
        <childnode refid="24476" relation="include">
        </childnode>
        <childnode refid="24470" relation="include">
        </childnode>
        <childnode refid="24473" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
      </node>
      <node id="24467">
        <label>unistd.h</label>
      </node>
      <node id="24574">
        <label>db_cxx.h</label>
      </node>
      <node id="24475">
        <label>vector</label>
      </node>
      <node id="24500">
        <label>bignum.h</label>
        <link refid="bignum_8h"/>
        <childnode refid="24476" relation="include">
        </childnode>
        <childnode refid="24470" relation="include">
        </childnode>
        <childnode refid="24501" relation="include">
        </childnode>
        <childnode refid="24473" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
        <childnode refid="24474" relation="include">
        </childnode>
      </node>
      <node id="24546">
        <label>net.h</label>
        <link refid="net_8h"/>
        <childnode refid="24547" relation="include">
        </childnode>
        <childnode refid="24548" relation="include">
        </childnode>
        <childnode refid="24498" relation="include">
        </childnode>
        <childnode refid="24549" relation="include">
        </childnode>
        <childnode refid="24520" relation="include">
        </childnode>
        <childnode refid="24550" relation="include">
        </childnode>
        <childnode refid="24551" relation="include">
        </childnode>
        <childnode refid="24552" relation="include">
        </childnode>
        <childnode refid="24561" relation="include">
        </childnode>
        <childnode refid="24563" relation="include">
        </childnode>
        <childnode refid="24469" relation="include">
        </childnode>
        <childnode refid="24535" relation="include">
        </childnode>
      </node>
      <node id="24486">
        <label>openssl/ripemd.h</label>
      </node>
      <node id="24512">
        <label>boost/filesystem.hpp</label>
      </node>
      <node id="24510">
        <label>utility</label>
      </node>
      <node id="24532">
        <label>compressor.h</label>
        <link refid="compressor_8h"/>
        <childnode refid="24494" relation="include">
        </childnode>
        <childnode refid="24533" relation="include">
        </childnode>
      </node>
      <node id="24508">
        <label>sstream</label>
      </node>
      <node id="24578">
        <label>boost/signals2/last_value.hpp</label>
      </node>
      <node id="24457">
        <label>key.h</label>
        <link refid="key_8h"/>
        <childnode refid="24458" relation="include">
        </childnode>
        <childnode refid="24468" relation="include">
        </childnode>
        <childnode refid="24473" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
      </node>
      <node id="24517">
        <label>openssl/evp.h</label>
      </node>
      <node id="24506">
        <label>tinyformat.h</label>
        <link refid="tinyformat_8h"/>
        <childnode refid="24478" relation="include">
        </childnode>
        <childnode refid="24507" relation="include">
        </childnode>
        <childnode refid="24508" relation="include">
        </childnode>
        <childnode refid="24473" relation="include">
        </childnode>
      </node>
      <node id="24474">
        <label>stdint.h</label>
        <link refid="stdint_8h"/>
      </node>
      <node id="24573">
        <label>db.h</label>
        <link refid="db_8h"/>
        <childnode refid="24476" relation="include">
        </childnode>
        <childnode refid="24525" relation="include">
        </childnode>
        <childnode refid="24535" relation="include">
        </childnode>
        <childnode refid="24464" relation="include">
        </childnode>
        <childnode refid="24462" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
        <childnode refid="24513" relation="include">
        </childnode>
        <childnode refid="24574" relation="include">
        </childnode>
      </node>
      <node id="24535">
        <label>streams.h</label>
        <link refid="streams_8h"/>
        <childnode refid="24458" relation="include">
        </childnode>
        <childnode refid="24476" relation="include">
        </childnode>
        <childnode refid="24536" relation="include">
        </childnode>
        <childnode refid="24471" relation="include">
        </childnode>
        <childnode refid="24537" relation="include">
        </childnode>
        <childnode refid="24479" relation="include">
        </childnode>
        <childnode refid="24464" relation="include">
        </childnode>
        <childnode refid="24477" relation="include">
        </childnode>
        <childnode refid="24474" relation="include">
        </childnode>
        <childnode refid="24462" relation="include">
        </childnode>
        <childnode refid="24461" relation="include">
        </childnode>
        <childnode refid="24510" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
      </node>
      <node id="24491">
        <label>crypto/argon2/argon2.h</label>
        <link refid="argon2_8h"/>
        <childnode refid="24474" relation="include">
        </childnode>
        <childnode refid="24490" relation="include">
        </childnode>
        <childnode refid="24466" relation="include">
        </childnode>
      </node>
      <node id="24582">
        <label>spork.h</label>
        <link refid="spork_8h"/>
        <childnode refid="24500" relation="include">
        </childnode>
        <childnode refid="24525" relation="include">
        </childnode>
        <childnode refid="24546" relation="include">
        </childnode>
        <childnode refid="24457" relation="include">
        </childnode>
        <childnode refid="24502" relation="include">
        </childnode>
        <childnode refid="24497" relation="include">
        </childnode>
        <childnode refid="24568" relation="include">
        </childnode>
        <childnode refid="24492" relation="include">
        </childnode>
        <childnode refid="24561" relation="include">
        </childnode>
        <childnode refid="24583" relation="include">
        </childnode>
        <childnode refid="24569" relation="include">
        </childnode>
      </node>
      <node id="24504">
        <label>sys/time.h</label>
      </node>
      <node id="24507">
        <label>iostream</label>
      </node>
      <node id="24547">
        <label>deque</label>
      </node>
      <node id="24470">
        <label>uint256.h</label>
        <link refid="uint256_8h"/>
        <childnode refid="24471" relation="include">
        </childnode>
        <childnode refid="24472" relation="include">
        </childnode>
        <childnode refid="24473" relation="include">
        </childnode>
        <childnode refid="24474" relation="include">
        </childnode>
        <childnode refid="24462" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
      </node>
      <node id="24555">
        <label>sys/socket.h</label>
      </node>
      <node id="24540">
        <label>leveldb/slice.h</label>
        <link refid="slice_8h"/>
        <childnode refid="24471" relation="include">
        </childnode>
        <childnode refid="24490" relation="include">
        </childnode>
        <childnode refid="24461" relation="include">
        </childnode>
        <childnode refid="24462" relation="include">
        </childnode>
      </node>
      <node id="24548">
        <label>boost/array.hpp</label>
      </node>
      <node id="24501">
        <label>openssl/bn.h</label>
      </node>
      <node id="24533">
        <label>txdb.h</label>
        <link refid="txdb_8h"/>
        <childnode refid="24534" relation="include">
        </childnode>
        <childnode refid="24492" relation="include">
        </childnode>
        <childnode refid="24464" relation="include">
        </childnode>
        <childnode refid="24462" relation="include">
        </childnode>
        <childnode refid="24510" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
      </node>
      <node id="24524">
        <label>timedata.h</label>
        <link refid="timedata_8h"/>
        <childnode refid="24474" relation="include">
        </childnode>
      </node>
      <node id="24458">
        <label>allocators.h</label>
        <link refid="allocators_8h"/>
        <childnode refid="24459" relation="include">
        </childnode>
        <childnode refid="24461" relation="include">
        </childnode>
        <childnode refid="24462" relation="include">
        </childnode>
        <childnode refid="24463" relation="include">
        </childnode>
        <childnode refid="24464" relation="include">
        </childnode>
        <childnode refid="24465" relation="include">
        </childnode>
        <childnode refid="24466" relation="include">
        </childnode>
        <childnode refid="24467" relation="include">
        </childnode>
      </node>
      <node id="24562">
        <label>chainparams.h</label>
        <link refid="chainparams_8h"/>
        <childnode refid="24500" relation="include">
        </childnode>
        <childnode refid="24470" relation="include">
        </childnode>
        <childnode refid="24475" relation="include">
        </childnode>
      </node>
      <node id="24477">
        <label>set</label>
      </node>
      <node id="24536">
        <label>algorithm</label>
      </node>
      <node id="24570">
        <label>activestormnode.h</label>
        <link refid="activestormnode_8h"/>
        <childnode refid="24525" relation="include">
        </childnode>
        <childnode refid="24457" relation="include">
        </childnode>
        <childnode refid="24571" relation="include">
        </childnode>
      </node>
      <node id="24487">
        <label>crypto/ripemd160.h</label>
        <link refid="ripemd160_8h"/>
        <childnode refid="24474" relation="include">
        </childnode>
        <childnode refid="24460" relation="include">
        </childnode>
      </node>
      <node id="24496">
        <label>util.h</label>
      </node>
      <node id="24522">
        <label>stdio.h</label>
      </node>
      <node id="24459">
        <label>cleanse.h</label>
        <link refid="cleanse_8h"/>
        <childnode refid="24460" relation="include">
        </childnode>
      </node>
      <node id="24472">
        <label>cstring</label>
      </node>
      <node id="24525">
        <label>sync.h</label>
        <link refid="sync_8h"/>
        <childnode refid="24526" relation="include">
        </childnode>
        <childnode refid="24527" relation="include">
        </childnode>
        <childnode refid="24528" relation="include">
        </childnode>
        <childnode refid="24463" relation="include">
        </childnode>
        <childnode refid="24529" relation="include">
        </childnode>
      </node>
      <node id="24523">
        <label>inttypes.h</label>
      </node>
      <node id="24539">
        <label>leveldb/iterator.h</label>
        <link refid="iterator_8h"/>
        <childnode refid="24540" relation="include">
        </childnode>
        <childnode refid="24541" relation="include">
        </childnode>
      </node>
      <node id="24565">
        <label>primitives/block.h</label>
        <link refid="primitives_2block_8h"/>
        <childnode refid="24494" relation="include">
        </childnode>
        <childnode refid="24491" relation="include">
        </childnode>
        <childnode refid="24566" relation="include">
        </childnode>
      </node>
    </incdepgraph>
      <sectiondef kind="var">
      <memberdef kind="variable" id="stormnode-sync_8cpp_1a4233fda53cfb60fd6ba208d981ac3fe7" prot="public" static="no" mutable="no">
        <type><ref refid="class_c_stormnode_sync" kindref="compound">CStormnodeSync</ref></type>
        <definition>CStormnodeSync stormnodeSync</definition>
        <argsstring></argsstring>
        <name>stormnodeSync</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/dev/ds-160209/src/stormnode-sync.cpp" line="16" column="1" bodyfile="/home/dev/ds-160209/src/stormnode-sync.cpp" bodystart="15" bodyend="-1"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//<sp/>Copyright<sp/>(c)<sp/>2014-2016<sp/>The<sp/>Dash<sp/>developers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Distributed<sp/>under<sp/>the<sp/>MIT/X11<sp/>software<sp/>license,<sp/>see<sp/>the<sp/>accompanying</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">//<sp/>file<sp/>COPYING<sp/>or<sp/>http://www.opensource.org/licenses/mit-license.php.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="stormnode-sync_8h" kindref="compound">stormnode-sync.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="activestormnode_8h" kindref="compound">activestormnode.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="stormnode-budget_8h" kindref="compound">stormnode-budget.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="stormnode-payments_8h" kindref="compound">stormnode-payments.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="stormnode_8h" kindref="compound">stormnode.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="stormnodeman_8h" kindref="compound">stormnodeman.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="spork_8h" kindref="compound">spork.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="util_8h" kindref="compound">util.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="addrman_8h" kindref="compound">addrman.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight></codeline>
<codeline lineno="15" refid="stormnode-sync_8h_1a4233fda53cfb60fd6ba208d981ac3fe7" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="class_c_stormnode_sync" kindref="compound">CStormnodeSync</ref>;</highlight></codeline>
<codeline lineno="16"><highlight class="normal"><ref refid="class_c_stormnode_sync" kindref="compound">CStormnodeSync</ref><sp/><ref refid="stormnode-sync_8cpp_1a4233fda53cfb60fd6ba208d981ac3fe7" kindref="member">stormnodeSync</ref>;</highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight></codeline>
<codeline lineno="18" refid="class_c_stormnode_sync_1ab51f592abb72b888aa291dc4e5f5ca01" refkind="member"><highlight class="normal"><ref refid="class_c_stormnode_sync_1ab51f592abb72b888aa291dc4e5f5ca01" kindref="member">CStormnodeSync::CStormnodeSync</ref>()</highlight></codeline>
<codeline lineno="19"><highlight class="normal">{</highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a14d6ee22d6cd11c4045b9fb8c7891551" kindref="member">Reset</ref>();</highlight></codeline>
<codeline lineno="21"><highlight class="normal">}</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight></codeline>
<codeline lineno="23" refid="class_c_stormnode_sync_1a0f196a2ca46b0cc4de3a488a4cbc2374" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_c_stormnode_sync_1a0f196a2ca46b0cc4de3a488a4cbc2374" kindref="member">CStormnodeSync::IsSynced</ref>()</highlight></codeline>
<codeline lineno="24"><highlight class="normal">{</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>==<sp/>STORMNODE_SYNC_FINISHED;</highlight></codeline>
<codeline lineno="26"><highlight class="normal">}</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight></codeline>
<codeline lineno="28" refid="class_c_stormnode_sync_1adfb3343f29476ca833084be0320a7d50" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_c_stormnode_sync_1adfb3343f29476ca833084be0320a7d50" kindref="member">CStormnodeSync::IsBlockchainSynced</ref>()</highlight></codeline>
<codeline lineno="29"><highlight class="normal">{</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>fBlockchainSynced<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="stdint_8h_1adec1df1b8b51cb32b77e5b86fff46471" kindref="member">int64_t</ref><sp/>lastProcess<sp/>=<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>();</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>the<sp/>last<sp/>call<sp/>to<sp/>this<sp/>function<sp/>was<sp/>more<sp/>than<sp/>60<sp/>minutes<sp/>ago<sp/>(client<sp/>was<sp/>in<sp/>sleep<sp/>mode)<sp/>reset<sp/>the<sp/>sync<sp/>process</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>()<sp/>-<sp/>lastProcess<sp/>&gt;<sp/>60*60)<sp/>{</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a14d6ee22d6cd11c4045b9fb8c7891551" kindref="member">Reset</ref>();</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fBlockchainSynced<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/>lastProcess<sp/>=<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>();</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(fBlockchainSynced)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="main_8cpp_1aaf87d0dd26c4a7c9bcc5bdd1127e8637" kindref="member">fImporting</ref><sp/>||<sp/><ref refid="main_8cpp_1a8e0eca589b2d4254a65f04c5d91888b2" kindref="member">fReindex</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sync_8h_1aca08e7299069c2d60b8aa726fc550612" kindref="member">TRY_LOCK</ref>(<ref refid="main_8cpp_1a1ed8285f0fe3c6799c53265ce72552c8" kindref="member">cs_main</ref>,<sp/>lockMain);</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!lockMain)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_block_index" kindref="compound">CBlockIndex</ref>*<sp/>pindex<sp/>=<sp/><ref refid="chain_8h_1a6454ad864029344132a0a0b59b1456ee" kindref="member">pindexBest</ref>;</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pindex<sp/>==<sp/>NULL)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pindex-&gt;<ref refid="class_c_block_index_1a4b687a226e9e166b0f91c1b616b543a6" kindref="member">nTime</ref><sp/>+<sp/>60*60<sp/>&lt;<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>())</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/>fBlockchainSynced<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="57"><highlight class="normal">}</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59" refid="class_c_stormnode_sync_1a14d6ee22d6cd11c4045b9fb8c7891551" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_c_stormnode_sync_1a14d6ee22d6cd11c4045b9fb8c7891551" kindref="member">CStormnodeSync::Reset</ref>()</highlight></codeline>
<codeline lineno="60"><highlight class="normal">{<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1aeb0a6f0e92f6f1f25c5d9fa6c2b15bbd" kindref="member">lastStormnodeList</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a84ac2bc44ac623f8e679f2ba58034c7a" kindref="member">lastStormnodeWinner</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a5499eabbf28dc8ec6f77cfef1569dbb7" kindref="member">lastBudgetItem</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1ab5874fbd02e921572983d1530cc7d69e" kindref="member">mapSeenSyncSNB</ref>.clear();</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1aa691249c2bfd876d49d24b82b3df7048" kindref="member">mapSeenSyncSNW</ref>.clear();</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a7555b263aa695f48c81f4051c1a4788c" kindref="member">mapSeenSyncBudget</ref>.clear();</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a8b236ed2df48f8d8fdbec1e07872f34f" kindref="member">lastFailure</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1ad7944c7fc57bc0288472b1f88fbd88e6" kindref="member">nCountFailures</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a3049bd8c09a2b946e99bb1ffca5ebd97" kindref="member">sumStormnodeList</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a37b84e2f05256e44f9d0c80a87b26895" kindref="member">sumStormnodeWinner</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a04a5e8c869c0b3802ce5ab2b8d0c7952" kindref="member">sumBudgetItemProp</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1ae54e3ff056c6bab202db68c4ceb0792e" kindref="member">sumBudgetItemFin</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a5b480191e47be00a7b1919244b5f9714" kindref="member">countStormnodeList</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1ad0db06b3a1913c0c40c8e6719953d346" kindref="member">countStormnodeWinner</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1af73aa6104e72c120d7def3f42bab1dc5" kindref="member">countBudgetItemProp</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a2a5824d8f6eddbdb6aec4daa51cae6a4" kindref="member">countBudgetItemFin</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>=<sp/>STORMNODE_SYNC_INITIAL;</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a2e7baab6709175db874ce9bc325c762d" kindref="member">nAssetSyncStarted</ref><sp/>=<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>();</highlight></codeline>
<codeline lineno="80"><highlight class="normal">}</highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight></codeline>
<codeline lineno="82" refid="class_c_stormnode_sync_1ad9e9ad7392c3fa1ec0af4b178b3c62c0" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_c_stormnode_sync_1ad9e9ad7392c3fa1ec0af4b178b3c62c0" kindref="member">CStormnodeSync::AddedStormnodeList</ref>(<ref refid="classuint256" kindref="compound">uint256</ref><sp/><ref refid="cache_8cc_1a11ecb029164e055f28f4123ce3748862" kindref="member">hash</ref>)</highlight></codeline>
<codeline lineno="83"><highlight class="normal">{</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="stormnodeman_8cpp_1a1e28814877e5fb4ed8113e3621ca13ff" kindref="member">snodeman</ref>.<ref refid="class_c_stormnode_man_1a320b85dcbbc8f01a412c96b23bca5424" kindref="member">mapSeenStormnodeBroadcast</ref>.count(hash))<sp/>{</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1ab5874fbd02e921572983d1530cc7d69e" kindref="member">mapSeenSyncSNB</ref>[hash]<sp/>&lt;<sp/>STORMNODE_SYNC_THRESHOLD)<sp/>{</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1aeb0a6f0e92f6f1f25c5d9fa6c2b15bbd" kindref="member">lastStormnodeList</ref><sp/>=<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>();</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1ab5874fbd02e921572983d1530cc7d69e" kindref="member">mapSeenSyncSNB</ref>[<ref refid="cache_8cc_1a11ecb029164e055f28f4123ce3748862" kindref="member">hash</ref>]++;</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1aeb0a6f0e92f6f1f25c5d9fa6c2b15bbd" kindref="member">lastStormnodeList</ref><sp/>=<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>();</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1ab5874fbd02e921572983d1530cc7d69e" kindref="member">mapSeenSyncSNB</ref>.insert(make_pair(hash,<sp/>1));</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="93"><highlight class="normal">}</highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight></codeline>
<codeline lineno="95" refid="class_c_stormnode_sync_1a686a36163137e9079365e7fd0ede826c" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_c_stormnode_sync_1a686a36163137e9079365e7fd0ede826c" kindref="member">CStormnodeSync::AddedStormnodeWinner</ref>(<ref refid="classuint256" kindref="compound">uint256</ref><sp/><ref refid="cache_8cc_1a11ecb029164e055f28f4123ce3748862" kindref="member">hash</ref>)</highlight></codeline>
<codeline lineno="96"><highlight class="normal">{</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="stormnode-payments_8cpp_1a1d528b1b067a2f669dfd90c513a97116" kindref="member">stormnodePayments</ref>.<ref refid="class_c_stormnode_payments_1a2227618f68b1655073c17d4b2ffe1c56" kindref="member">mapStormnodePayeeVotes</ref>.count(hash))<sp/>{</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1aa691249c2bfd876d49d24b82b3df7048" kindref="member">mapSeenSyncSNW</ref>[hash]<sp/>&lt;<sp/>STORMNODE_SYNC_THRESHOLD)<sp/>{</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a84ac2bc44ac623f8e679f2ba58034c7a" kindref="member">lastStormnodeWinner</ref><sp/>=<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>();</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1aa691249c2bfd876d49d24b82b3df7048" kindref="member">mapSeenSyncSNW</ref>[<ref refid="cache_8cc_1a11ecb029164e055f28f4123ce3748862" kindref="member">hash</ref>]++;</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a84ac2bc44ac623f8e679f2ba58034c7a" kindref="member">lastStormnodeWinner</ref><sp/>=<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>();</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1aa691249c2bfd876d49d24b82b3df7048" kindref="member">mapSeenSyncSNW</ref>.insert(make_pair(hash,<sp/>1));</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="106"><highlight class="normal">}</highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108" refid="class_c_stormnode_sync_1af200f11664c64e5256ad77bd0465b634" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_c_stormnode_sync_1af200f11664c64e5256ad77bd0465b634" kindref="member">CStormnodeSync::AddedBudgetItem</ref>(<ref refid="classuint256" kindref="compound">uint256</ref><sp/><ref refid="cache_8cc_1a11ecb029164e055f28f4123ce3748862" kindref="member">hash</ref>)</highlight></codeline>
<codeline lineno="109"><highlight class="normal">{</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="stormnode-budget_8cpp_1ad9842d355854ad5602728a96cf684706" kindref="member">budget</ref>.<ref refid="class_c_budget_manager_1a5336c99bc4c72c185de0391165a67159" kindref="member">mapSeenStormnodeBudgetProposals</ref>.count(hash)<sp/>||<sp/><ref refid="stormnode-budget_8cpp_1ad9842d355854ad5602728a96cf684706" kindref="member">budget</ref>.<ref refid="class_c_budget_manager_1af729951208566289252458a01ed9fc7a" kindref="member">mapSeenStormnodeBudgetVotes</ref>.count(hash)<sp/>||</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="stormnode-budget_8cpp_1ad9842d355854ad5602728a96cf684706" kindref="member">budget</ref>.<ref refid="class_c_budget_manager_1a289e14968fc776b8c0570b03ea8c8ecd" kindref="member">mapSeenFinalizedBudgets</ref>.count(hash)<sp/>||<sp/><ref refid="stormnode-budget_8cpp_1ad9842d355854ad5602728a96cf684706" kindref="member">budget</ref>.<ref refid="class_c_budget_manager_1aecbf6ad23e6f6044672d5619d3e7c40d" kindref="member">mapSeenFinalizedBudgetVotes</ref>.count(hash))<sp/>{</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1a7555b263aa695f48c81f4051c1a4788c" kindref="member">mapSeenSyncBudget</ref>[hash]<sp/>&lt;<sp/>STORMNODE_SYNC_THRESHOLD)<sp/>{</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a5499eabbf28dc8ec6f77cfef1569dbb7" kindref="member">lastBudgetItem</ref><sp/>=<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>();</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a7555b263aa695f48c81f4051c1a4788c" kindref="member">mapSeenSyncBudget</ref>[<ref refid="cache_8cc_1a11ecb029164e055f28f4123ce3748862" kindref="member">hash</ref>]++;</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a5499eabbf28dc8ec6f77cfef1569dbb7" kindref="member">lastBudgetItem</ref><sp/>=<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>();</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a7555b263aa695f48c81f4051c1a4788c" kindref="member">mapSeenSyncBudget</ref>.insert(make_pair(hash,<sp/>1));</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="120"><highlight class="normal">}</highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight></codeline>
<codeline lineno="122" refid="class_c_stormnode_sync_1a85c30a78fdad0ac91f6fc1a4c17077e5" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_c_stormnode_sync_1a85c30a78fdad0ac91f6fc1a4c17077e5" kindref="member">CStormnodeSync::IsBudgetPropEmpty</ref>()</highlight></codeline>
<codeline lineno="123"><highlight class="normal">{</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_c_stormnode_sync_1a04a5e8c869c0b3802ce5ab2b8d0c7952" kindref="member">sumBudgetItemProp</ref>==0<sp/>&amp;&amp;<sp/><ref refid="class_c_stormnode_sync_1af73aa6104e72c120d7def3f42bab1dc5" kindref="member">countBudgetItemProp</ref>&gt;0;</highlight></codeline>
<codeline lineno="125"><highlight class="normal">}</highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight></codeline>
<codeline lineno="127" refid="class_c_stormnode_sync_1a71a5cb2516527d38bca276b5bc90c3f1" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_c_stormnode_sync_1a71a5cb2516527d38bca276b5bc90c3f1" kindref="member">CStormnodeSync::IsBudgetFinEmpty</ref>()</highlight></codeline>
<codeline lineno="128"><highlight class="normal">{</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_c_stormnode_sync_1ae54e3ff056c6bab202db68c4ceb0792e" kindref="member">sumBudgetItemFin</ref>==0<sp/>&amp;&amp;<sp/><ref refid="class_c_stormnode_sync_1a2a5824d8f6eddbdb6aec4daa51cae6a4" kindref="member">countBudgetItemFin</ref>&gt;0;</highlight></codeline>
<codeline lineno="130"><highlight class="normal">}</highlight></codeline>
<codeline lineno="131"><highlight class="normal"></highlight></codeline>
<codeline lineno="132" refid="class_c_stormnode_sync_1a3c70130712267c3c100a69d35b97acf8" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_c_stormnode_sync_1a3c70130712267c3c100a69d35b97acf8" kindref="member">CStormnodeSync::GetNextAsset</ref>()</highlight></codeline>
<codeline lineno="133"><highlight class="normal">{</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref>)</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal">(STORMNODE_SYNC_INITIAL):</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal">(STORMNODE_SYNC_FAILED):<sp/></highlight><highlight class="comment">//<sp/>should<sp/>never<sp/>be<sp/>used<sp/>here<sp/>actually,<sp/>use<sp/>Reset()<sp/>instead</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a4852378d102b54360f8656731d264c04" kindref="member">ClearFulfilledRequest</ref>();</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>=<sp/>STORMNODE_SYNC_SPORKS;</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal">(STORMNODE_SYNC_SPORKS):</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>=<sp/>STORMNODE_SYNC_LIST;</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal">(STORMNODE_SYNC_LIST):</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>=<sp/>STORMNODE_SYNC_SNW;</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal">(STORMNODE_SYNC_SNW):</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>=<sp/>STORMNODE_SYNC_BUDGET;</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal">(STORMNODE_SYNC_BUDGET):</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="util_8h_1afc02c0a4258fedfb316be612bb659ba8" kindref="member">LogPrintf</ref>(</highlight><highlight class="stringliteral">&quot;CStormnodeSync::GetNextAsset<sp/>-<sp/>Sync<sp/>has<sp/>finished\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>=<sp/>STORMNODE_SYNC_FINISHED;</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a2e7baab6709175db874ce9bc325c762d" kindref="member">nAssetSyncStarted</ref><sp/>=<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>();</highlight></codeline>
<codeline lineno="157"><highlight class="normal">}</highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight></codeline>
<codeline lineno="159" refid="class_c_stormnode_sync_1a11096b1811db2d0b8d495a82010969d9" refkind="member"><highlight class="normal">std::string<sp/><ref refid="class_c_stormnode_sync_1a11096b1811db2d0b8d495a82010969d9" kindref="member">CStormnodeSync::GetSyncStatus</ref>()</highlight></codeline>
<codeline lineno="160"><highlight class="normal">{</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(stormnodeSync.<ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref>)<sp/>{</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>STORMNODE_SYNC_INITIAL:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ui__interface_8h_1aad133bb6103b53cebf03fd01e2f11ba1" kindref="member">_</ref>(</highlight><highlight class="stringliteral">&quot;Synchronization<sp/>pending...&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>STORMNODE_SYNC_SPORKS:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ui__interface_8h_1aad133bb6103b53cebf03fd01e2f11ba1" kindref="member">_</ref>(</highlight><highlight class="stringliteral">&quot;Synchronizing<sp/>sporks...&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>STORMNODE_SYNC_LIST:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ui__interface_8h_1aad133bb6103b53cebf03fd01e2f11ba1" kindref="member">_</ref>(</highlight><highlight class="stringliteral">&quot;Synchronizing<sp/>stormnodes...&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>STORMNODE_SYNC_SNW:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ui__interface_8h_1aad133bb6103b53cebf03fd01e2f11ba1" kindref="member">_</ref>(</highlight><highlight class="stringliteral">&quot;Synchronizing<sp/>stormnode<sp/>winners...&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>STORMNODE_SYNC_BUDGET:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ui__interface_8h_1aad133bb6103b53cebf03fd01e2f11ba1" kindref="member">_</ref>(</highlight><highlight class="stringliteral">&quot;Synchronizing<sp/>budgets...&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>STORMNODE_SYNC_FAILED:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ui__interface_8h_1aad133bb6103b53cebf03fd01e2f11ba1" kindref="member">_</ref>(</highlight><highlight class="stringliteral">&quot;Synchronization<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>STORMNODE_SYNC_FINISHED:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ui__interface_8h_1aad133bb6103b53cebf03fd01e2f11ba1" kindref="member">_</ref>(</highlight><highlight class="stringliteral">&quot;Synchronization<sp/>finished&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="171"><highlight class="normal">}</highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight></codeline>
<codeline lineno="173" refid="class_c_stormnode_sync_1aaca810ce9a48fed7e8608f73c0d5f29d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_c_stormnode_sync_1aaca810ce9a48fed7e8608f73c0d5f29d" kindref="member">CStormnodeSync::ProcessMessage</ref>(<ref refid="class_c_node" kindref="compound">CNode</ref>*<sp/>pfrom,<sp/>std::string&amp;<sp/>strCommand,<sp/><ref refid="class_c_data_stream" kindref="compound">CDataStream</ref>&amp;<sp/>vRecv)</highlight></codeline>
<codeline lineno="174"><highlight class="normal">{</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strCommand<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;ssc&quot;</highlight><highlight class="normal">)<sp/>{<sp/></highlight><highlight class="comment">//Sync<sp/>status<sp/>count</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nItemID;</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nCount;</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vRecv<sp/>&gt;&gt;<sp/>nItemID<sp/>&gt;&gt;<sp/>nCount;</highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>&gt;=<sp/>STORMNODE_SYNC_FINISHED)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//this<sp/>means<sp/>we<sp/>will<sp/>receive<sp/>no<sp/>further<sp/>communication</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(nItemID)</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal">(STORMNODE_SYNC_LIST):</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(nItemID<sp/>!=<sp/><ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a3049bd8c09a2b946e99bb1ffca5ebd97" kindref="member">sumStormnodeList</ref><sp/>+=<sp/>nCount;</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a5b480191e47be00a7b1919244b5f9714" kindref="member">countStormnodeList</ref>++;</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal">(STORMNODE_SYNC_SNW):</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(nItemID<sp/>!=<sp/><ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a37b84e2f05256e44f9d0c80a87b26895" kindref="member">sumStormnodeWinner</ref><sp/>+=<sp/>nCount;</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1ad0db06b3a1913c0c40c8e6719953d346" kindref="member">countStormnodeWinner</ref>++;</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal">(STORMNODE_SYNC_BUDGET_PROP):</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>!=<sp/>STORMNODE_SYNC_BUDGET)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a04a5e8c869c0b3802ce5ab2b8d0c7952" kindref="member">sumBudgetItemProp</ref><sp/>+=<sp/>nCount;</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1af73aa6104e72c120d7def3f42bab1dc5" kindref="member">countBudgetItemProp</ref>++;</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal">(STORMNODE_SYNC_BUDGET_FIN):</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>!=<sp/>STORMNODE_SYNC_BUDGET)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1ae54e3ff056c6bab202db68c4ceb0792e" kindref="member">sumBudgetItemFin</ref><sp/>+=<sp/>nCount;</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a2a5824d8f6eddbdb6aec4daa51cae6a4" kindref="member">countBudgetItemFin</ref>++;</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="util_8h_1afc02c0a4258fedfb316be612bb659ba8" kindref="member">LogPrintf</ref>(</highlight><highlight class="stringliteral">&quot;CStormnodeSync:ProcessMessage<sp/>-<sp/>ssc<sp/>-<sp/>got<sp/>inventory<sp/>count<sp/>%d<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>nItemID,<sp/>nCount);</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="209"><highlight class="normal">}</highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight></codeline>
<codeline lineno="211" refid="class_c_stormnode_sync_1a4852378d102b54360f8656731d264c04" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_c_stormnode_sync_1a4852378d102b54360f8656731d264c04" kindref="member">CStormnodeSync::ClearFulfilledRequest</ref>()</highlight></codeline>
<codeline lineno="212"><highlight class="normal">{</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sync_8h_1aca08e7299069c2d60b8aa726fc550612" kindref="member">TRY_LOCK</ref>(<ref refid="net_8cpp_1a8282e3a7948351ac96516573cd31f9d0" kindref="member">cs_vNodes</ref>,<sp/>lockRecv);</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!lockRecv)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/>BOOST_FOREACH(<ref refid="class_c_node" kindref="compound">CNode</ref>*<sp/>pnode,<sp/><ref refid="net_8cpp_1aa5a11f8873e230cea77bc7e91ee51918" kindref="member">vNodes</ref>)</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pnode-&gt;<ref refid="class_c_node_1aa57c7ad448501f5c8667d430b390b5ea" kindref="member">ClearFulfilledRequest</ref>(</highlight><highlight class="stringliteral">&quot;getspork&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pnode-&gt;<ref refid="class_c_node_1aa57c7ad448501f5c8667d430b390b5ea" kindref="member">ClearFulfilledRequest</ref>(</highlight><highlight class="stringliteral">&quot;snsync&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pnode-&gt;<ref refid="class_c_node_1aa57c7ad448501f5c8667d430b390b5ea" kindref="member">ClearFulfilledRequest</ref>(</highlight><highlight class="stringliteral">&quot;snwsync&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pnode-&gt;<ref refid="class_c_node_1aa57c7ad448501f5c8667d430b390b5ea" kindref="member">ClearFulfilledRequest</ref>(</highlight><highlight class="stringliteral">&quot;busync&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="223"><highlight class="normal">}</highlight></codeline>
<codeline lineno="224"><highlight class="normal"></highlight></codeline>
<codeline lineno="225" refid="class_c_stormnode_sync_1adaaeb592c3432c8a459560523c7be207" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_c_stormnode_sync_1adaaeb592c3432c8a459560523c7be207" kindref="member">CStormnodeSync::Process</ref>()</highlight></codeline>
<codeline lineno="226"><highlight class="normal">{</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tick<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(tick++<sp/>%<sp/>STORMNODE_SYNC_TIMEOUT<sp/>!=<sp/>0)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1a0f196a2ca46b0cc4de3a488a4cbc2374" kindref="member">IsSynced</ref>())<sp/>{</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/></highlight></codeline>
<codeline lineno="233"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Resync<sp/>if<sp/>we<sp/>lose<sp/>all<sp/>stormnodes<sp/>from<sp/>sleep/wake<sp/>or<sp/>failure<sp/>to<sp/>sync<sp/>originally</highlight></codeline>
<codeline lineno="234"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="stormnodeman_8cpp_1a1e28814877e5fb4ed8113e3621ca13ff" kindref="member">snodeman</ref>.<ref refid="class_c_stormnode_man_1a02b9b11565e19f2c9dafbe132341fabd" kindref="member">CountEnabled</ref>()<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a14d6ee22d6cd11c4045b9fb8c7891551" kindref="member">Reset</ref>();</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="240"><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//try<sp/>syncing<sp/>again</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>==<sp/>STORMNODE_SYNC_FAILED<sp/>&amp;&amp;<sp/><ref refid="class_c_stormnode_sync_1a8b236ed2df48f8d8fdbec1e07872f34f" kindref="member">lastFailure</ref><sp/>+<sp/>(1*60)<sp/>&lt;<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>())<sp/>{</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a14d6ee22d6cd11c4045b9fb8c7891551" kindref="member">Reset</ref>();</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>==<sp/>STORMNODE_SYNC_FAILED)<sp/>{</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="247"><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="util_8cpp_1a2ba7badc843121dde40a6f109d224a42" kindref="member">fDebug</ref>)<sp/><ref refid="util_8h_1afc02c0a4258fedfb316be612bb659ba8" kindref="member">LogPrintf</ref>(</highlight><highlight class="stringliteral">&quot;CStormnodeSync::Process()<sp/>-<sp/>tick<sp/>%d<sp/>RequestedStormnodeAssets<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>tick,<sp/><ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref>);</highlight></codeline>
<codeline lineno="249"><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>==<sp/>STORMNODE_SYNC_INITIAL)<sp/><ref refid="class_c_stormnode_sync_1a3c70130712267c3c100a69d35b97acf8" kindref="member">GetNextAsset</ref>();</highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>sporks<sp/>synced<sp/>but<sp/>blockchain<sp/>is<sp/>not,<sp/>wait<sp/>until<sp/>we&apos;re<sp/>almost<sp/>at<sp/>a<sp/>recent<sp/>block<sp/>to<sp/>continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="chainparams_8cpp_1ace5c5b706d71a324a417dd2db394fd4a" kindref="member">Params</ref>().NetworkID()<sp/>!=<sp/><ref refid="class_c_chain_params_1a5c4bb1d7c0205399ff06ee58fab7f176a7bfe4c44c13adffa9807917840050c60" kindref="member">CChainParams::TESTNET</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!<ref refid="class_c_stormnode_sync_1adfb3343f29476ca833084be0320a7d50" kindref="member">IsBlockchainSynced</ref>()<sp/>&amp;&amp;<sp/><ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>&gt;<sp/>STORMNODE_SYNC_SPORKS)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="255"><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sync_8h_1aca08e7299069c2d60b8aa726fc550612" kindref="member">TRY_LOCK</ref>(<ref refid="net_8cpp_1a8282e3a7948351ac96516573cd31f9d0" kindref="member">cs_vNodes</ref>,<sp/>lockRecv);</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!lockRecv)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="258"><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/>BOOST_FOREACH(<ref refid="class_c_node" kindref="compound">CNode</ref>*<sp/>pnode,<sp/><ref refid="net_8cpp_1aa5a11f8873e230cea77bc7e91ee51918" kindref="member">vNodes</ref>)</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="chainparams_8cpp_1ace5c5b706d71a324a417dd2db394fd4a" kindref="member">Params</ref>().NetworkID()<sp/>==<sp/><ref refid="class_c_chain_params_1a5c4bb1d7c0205399ff06ee58fab7f176a7bfe4c44c13adffa9807917840050c60" kindref="member">CChainParams::TESTNET</ref>){</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref><sp/>&lt;=<sp/>2)<sp/>{</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pnode-&gt;<ref refid="class_c_node_1a204fda3d33404cb37698c085b1583ab2" kindref="member">PushMessage</ref>(</highlight><highlight class="stringliteral">&quot;getsporks&quot;</highlight><highlight class="normal">);<sp/></highlight><highlight class="comment">//get<sp/>current<sp/>network<sp/>sporks</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref><sp/>&lt;<sp/>4)<sp/>{</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="stormnodeman_8cpp_1a1e28814877e5fb4ed8113e3621ca13ff" kindref="member">snodeman</ref>.<ref refid="class_c_stormnode_man_1a3f8f9f86f01df701533b544903b55113" kindref="member">SsegUpdate</ref>(pnode);</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref><sp/>&lt;<sp/>6)<sp/>{</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nSnCount<sp/>=<sp/><ref refid="stormnodeman_8cpp_1a1e28814877e5fb4ed8113e3621ca13ff" kindref="member">snodeman</ref>.<ref refid="class_c_stormnode_man_1a02b9b11565e19f2c9dafbe132341fabd" kindref="member">CountEnabled</ref>();</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pnode-&gt;<ref refid="class_c_node_1a204fda3d33404cb37698c085b1583ab2" kindref="member">PushMessage</ref>(</highlight><highlight class="stringliteral">&quot;snget&quot;</highlight><highlight class="normal">,<sp/>nSnCount);<sp/></highlight><highlight class="comment">//sync<sp/>payees</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classuint256" kindref="compound">uint256</ref><sp/>n<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pnode-&gt;<ref refid="class_c_node_1a204fda3d33404cb37698c085b1583ab2" kindref="member">PushMessage</ref>(</highlight><highlight class="stringliteral">&quot;snvs&quot;</highlight><highlight class="normal">,<sp/>n);<sp/></highlight><highlight class="comment">//sync<sp/>stormnode<sp/>votes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>=<sp/>STORMNODE_SYNC_FINISHED;</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref>++;</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="277"><highlight class="normal"></highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//set<sp/>to<sp/>synced</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>==<sp/>STORMNODE_SYNC_SPORKS){</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pnode-&gt;<ref refid="class_c_node_1ae94af0e82ca84242e420fc53debe6f25" kindref="member">HasFulfilledRequest</ref>(</highlight><highlight class="stringliteral">&quot;getspork&quot;</highlight><highlight class="normal">))<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pnode-&gt;<ref refid="class_c_node_1a5b378bdd447e2f1e63ced2ae5b36ed76" kindref="member">FulfilledRequest</ref>(</highlight><highlight class="stringliteral">&quot;getspork&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="282"><highlight class="normal"></highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pnode-&gt;<ref refid="class_c_node_1a204fda3d33404cb37698c085b1583ab2" kindref="member">PushMessage</ref>(</highlight><highlight class="stringliteral">&quot;getsporks&quot;</highlight><highlight class="normal">);<sp/></highlight><highlight class="comment">//get<sp/>current<sp/>network<sp/>sporks</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref><sp/>&gt;=<sp/>2)<sp/><ref refid="class_c_stormnode_sync_1a3c70130712267c3c100a69d35b97acf8" kindref="member">GetNextAsset</ref>();</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref>++;</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pnode-&gt;<ref refid="class_c_node_1a99173eb3cef17e699ba21a5249ac33d2" kindref="member">nVersion</ref><sp/>&gt;=<sp/><ref refid="stormnode-payments_8cpp_1a1d528b1b067a2f669dfd90c513a97116" kindref="member">stormnodePayments</ref>.<ref refid="class_c_stormnode_payments_1a98392b86e945308c9c66f1cd4942a220" kindref="member">GetMinStormnodePaymentsProto</ref>())<sp/>{</highlight></codeline>
<codeline lineno="291"><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>==<sp/>STORMNODE_SYNC_LIST)<sp/>{</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="util_8cpp_1a2ba7badc843121dde40a6f109d224a42" kindref="member">fDebug</ref>)<sp/><ref refid="util_8h_1afc02c0a4258fedfb316be612bb659ba8" kindref="member">LogPrintf</ref>(</highlight><highlight class="stringliteral">&quot;CStormnodeSync::Process()<sp/>-<sp/>lastStormnodeList<sp/>%lld<sp/>(GetTime()<sp/>-<sp/>STORMNODE_SYNC_TIMEOUT)<sp/>%lld\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="class_c_stormnode_sync_1aeb0a6f0e92f6f1f25c5d9fa6c2b15bbd" kindref="member">lastStormnodeList</ref>,<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>()<sp/>-<sp/>STORMNODE_SYNC_TIMEOUT);</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1aeb0a6f0e92f6f1f25c5d9fa6c2b15bbd" kindref="member">lastStormnodeList</ref><sp/>&gt;<sp/>0<sp/>&amp;&amp;<sp/><ref refid="class_c_stormnode_sync_1aeb0a6f0e92f6f1f25c5d9fa6c2b15bbd" kindref="member">lastStormnodeList</ref><sp/>&lt;<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>()<sp/>-<sp/>STORMNODE_SYNC_TIMEOUT<sp/>*<sp/>2<sp/>&amp;&amp;<sp/><ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref><sp/>&gt;=<sp/>STORMNODE_SYNC_THRESHOLD){<sp/></highlight><highlight class="comment">//hasn&apos;t<sp/>received<sp/>a<sp/>new<sp/>item<sp/>in<sp/>the<sp/>last<sp/>five<sp/>seconds,<sp/>so<sp/>we&apos;ll<sp/>move<sp/>to<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a3c70130712267c3c100a69d35b97acf8" kindref="member">GetNextAsset</ref>();</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="298"><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pnode-&gt;<ref refid="class_c_node_1ae94af0e82ca84242e420fc53debe6f25" kindref="member">HasFulfilledRequest</ref>(</highlight><highlight class="stringliteral">&quot;snsync&quot;</highlight><highlight class="normal">))<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pnode-&gt;<ref refid="class_c_node_1a5b378bdd447e2f1e63ced2ae5b36ed76" kindref="member">FulfilledRequest</ref>(</highlight><highlight class="stringliteral">&quot;snsync&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>timeout</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1aeb0a6f0e92f6f1f25c5d9fa6c2b15bbd" kindref="member">lastStormnodeList</ref><sp/>==<sp/>0<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref><sp/>&gt;=<sp/>STORMNODE_SYNC_THRESHOLD<sp/>*<sp/>3<sp/>||<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>()<sp/>-<sp/><ref refid="class_c_stormnode_sync_1a2e7baab6709175db874ce9bc325c762d" kindref="member">nAssetSyncStarted</ref><sp/>&gt;<sp/>STORMNODE_SYNC_TIMEOUT<sp/>*<sp/>5))<sp/>{</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="spork_8cpp_1a3305663176e21e81c80dc951a7f8ea5e" kindref="member">IsSporkActive</ref>(SPORK_8_STORMNODE_PAYMENT_ENFORCEMENT))<sp/>{</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="util_8h_1afc02c0a4258fedfb316be612bb659ba8" kindref="member">LogPrintf</ref>(</highlight><highlight class="stringliteral">&quot;CStormnodeSync::Process<sp/>-<sp/>ERROR<sp/>-<sp/>Sync<sp/>has<sp/>failed,<sp/>will<sp/>retry<sp/>later\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>=<sp/>STORMNODE_SYNC_FAILED;</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a8b236ed2df48f8d8fdbec1e07872f34f" kindref="member">lastFailure</ref><sp/>=<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>();</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1ad7944c7fc57bc0288472b1f88fbd88e6" kindref="member">nCountFailures</ref>++;</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a3c70130712267c3c100a69d35b97acf8" kindref="member">GetNextAsset</ref>();</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="316"><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref><sp/>&gt;=<sp/>STORMNODE_SYNC_THRESHOLD<sp/>*<sp/>3)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="318"><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="stormnodeman_8cpp_1a1e28814877e5fb4ed8113e3621ca13ff" kindref="member">snodeman</ref>.<ref refid="class_c_stormnode_man_1a3f8f9f86f01df701533b544903b55113" kindref="member">SsegUpdate</ref>(pnode);</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref>++;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>==<sp/>STORMNODE_SYNC_SNW)<sp/>{</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1a84ac2bc44ac623f8e679f2ba58034c7a" kindref="member">lastStormnodeWinner</ref><sp/>&gt;<sp/>0<sp/>&amp;&amp;<sp/><ref refid="class_c_stormnode_sync_1a84ac2bc44ac623f8e679f2ba58034c7a" kindref="member">lastStormnodeWinner</ref><sp/>&lt;<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>()<sp/>-<sp/>STORMNODE_SYNC_TIMEOUT<sp/>*<sp/>2<sp/>&amp;&amp;<sp/><ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref><sp/>&gt;=<sp/>STORMNODE_SYNC_THRESHOLD){<sp/></highlight><highlight class="comment">//hasn&apos;t<sp/>received<sp/>a<sp/>new<sp/>item<sp/>in<sp/>the<sp/>last<sp/>five<sp/>seconds,<sp/>so<sp/>we&apos;ll<sp/>move<sp/>to<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a3c70130712267c3c100a69d35b97acf8" kindref="member">GetNextAsset</ref>();</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="329"><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pnode-&gt;<ref refid="class_c_node_1ae94af0e82ca84242e420fc53debe6f25" kindref="member">HasFulfilledRequest</ref>(</highlight><highlight class="stringliteral">&quot;snwsync&quot;</highlight><highlight class="normal">))<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pnode-&gt;<ref refid="class_c_node_1a5b378bdd447e2f1e63ced2ae5b36ed76" kindref="member">FulfilledRequest</ref>(</highlight><highlight class="stringliteral">&quot;snwsync&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="332"><highlight class="normal"></highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>timeout</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1a84ac2bc44ac623f8e679f2ba58034c7a" kindref="member">lastStormnodeWinner</ref><sp/>==<sp/>0<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref><sp/>&gt;=<sp/>STORMNODE_SYNC_THRESHOLD<sp/>*<sp/>3<sp/>||<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>()<sp/>-<sp/><ref refid="class_c_stormnode_sync_1a2e7baab6709175db874ce9bc325c762d" kindref="member">nAssetSyncStarted</ref><sp/>&gt;<sp/>STORMNODE_SYNC_TIMEOUT<sp/>*<sp/>5))<sp/>{</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="spork_8cpp_1a3305663176e21e81c80dc951a7f8ea5e" kindref="member">IsSporkActive</ref>(SPORK_8_STORMNODE_PAYMENT_ENFORCEMENT))<sp/>{</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="util_8h_1afc02c0a4258fedfb316be612bb659ba8" kindref="member">LogPrintf</ref>(</highlight><highlight class="stringliteral">&quot;CStormnodeSync::Process<sp/>-<sp/>ERROR<sp/>-<sp/>Sync<sp/>has<sp/>failed,<sp/>will<sp/>retry<sp/>later\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>=<sp/>STORMNODE_SYNC_FAILED;</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a8b236ed2df48f8d8fdbec1e07872f34f" kindref="member">lastFailure</ref><sp/>=<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>();</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1ad7944c7fc57bc0288472b1f88fbd88e6" kindref="member">nCountFailures</ref>++;</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a3c70130712267c3c100a69d35b97acf8" kindref="member">GetNextAsset</ref>();</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="347"><highlight class="normal"></highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref><sp/>&gt;=<sp/>STORMNODE_SYNC_THRESHOLD<sp/>*<sp/>3)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="349"><highlight class="normal"></highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_block_index" kindref="compound">CBlockIndex</ref>*<sp/>pindexPrev<sp/>=<sp/><ref refid="chain_8h_1a6454ad864029344132a0a0b59b1456ee" kindref="member">pindexBest</ref>;</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pindexPrev<sp/>==<sp/>NULL)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="352"><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nSnCount<sp/>=<sp/><ref refid="stormnodeman_8cpp_1a1e28814877e5fb4ed8113e3621ca13ff" kindref="member">snodeman</ref>.<ref refid="class_c_stormnode_man_1a02b9b11565e19f2c9dafbe132341fabd" kindref="member">CountEnabled</ref>();</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pnode-&gt;<ref refid="class_c_node_1a204fda3d33404cb37698c085b1583ab2" kindref="member">PushMessage</ref>(</highlight><highlight class="stringliteral">&quot;snget&quot;</highlight><highlight class="normal">,<sp/>nSnCount);<sp/></highlight><highlight class="comment">//sync<sp/>payees</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref>++;</highlight></codeline>
<codeline lineno="356"><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="360"><highlight class="normal"></highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pnode-&gt;<ref refid="class_c_node_1a99173eb3cef17e699ba21a5249ac33d2" kindref="member">nVersion</ref><sp/>&gt;=<sp/>MIN_BUDGET_PEER_PROTO_VERSION)<sp/>{</highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1abd82a675dc58c17710dac55b20426945" kindref="member">RequestedStormnodeAssets</ref><sp/>==<sp/>STORMNODE_SYNC_BUDGET){</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//we&apos;ll<sp/>start<sp/>rejecting<sp/>votes<sp/>if<sp/>we<sp/>accidentally<sp/>get<sp/>set<sp/>as<sp/>synced<sp/>too<sp/>soon</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1a5499eabbf28dc8ec6f77cfef1569dbb7" kindref="member">lastBudgetItem</ref><sp/>&gt;<sp/>0<sp/>&amp;&amp;<sp/><ref refid="class_c_stormnode_sync_1a5499eabbf28dc8ec6f77cfef1569dbb7" kindref="member">lastBudgetItem</ref><sp/>&lt;<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>()<sp/>-<sp/>STORMNODE_SYNC_TIMEOUT<sp/>*<sp/>2<sp/>&amp;&amp;<sp/><ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref><sp/>&gt;=<sp/>STORMNODE_SYNC_THRESHOLD){<sp/></highlight><highlight class="comment">//hasn&apos;t<sp/>received<sp/>a<sp/>new<sp/>item<sp/>in<sp/>the<sp/>last<sp/>five<sp/>seconds,<sp/>so<sp/>we&apos;ll<sp/>move<sp/>to<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//LogPrintf(&quot;CStormnodeSync::Process<sp/>-<sp/>HasNextFinalizedBudget<sp/>%d<sp/>nCountFailures<sp/>%d<sp/>IsBudgetPropEmpty<sp/>%d\n&quot;,<sp/>budget.HasNextFinalizedBudget(),<sp/>nCountFailures,<sp/>IsBudgetPropEmpty());</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//if(budget.HasNextFinalizedBudget()<sp/>||<sp/>nCountFailures<sp/>&gt;=<sp/>2<sp/>||<sp/>IsBudgetPropEmpty())<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a3c70130712267c3c100a69d35b97acf8" kindref="member">GetNextAsset</ref>();</highlight></codeline>
<codeline lineno="369"><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//try<sp/>to<sp/>activate<sp/>our<sp/>stormnode<sp/>if<sp/>possible</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sandstorm_8cpp_1ac75d1761e37a1f1cbf71007bcbadf5b0" kindref="member">activeStormnode</ref>.<ref refid="class_c_active_stormnode_1a9532e0804ea4c96ad7d58ab3e9da6891" kindref="member">ManageStatus</ref>();</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>}<sp/>else<sp/>{<sp/>//we&apos;ve<sp/>failed<sp/>to<sp/>sync,<sp/>this<sp/>state<sp/>will<sp/>reject<sp/>the<sp/>next<sp/>budget<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>LogPrintf(&quot;CStormnodeSync::Process<sp/>-<sp/>ERROR<sp/>-<sp/>Sync<sp/>has<sp/>failed,<sp/>will<sp/>retry<sp/>later\n&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>RequestedStormnodeAssets<sp/>=<sp/>STORMNODE_SYNC_FAILED;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>RequestedStormnodeAttempt<sp/>=<sp/>0;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>lastFailure<sp/>=<sp/>GetTime();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>nCountFailures++;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="381"><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>timeout</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1a5499eabbf28dc8ec6f77cfef1569dbb7" kindref="member">lastBudgetItem</ref><sp/>==<sp/>0<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref><sp/>&gt;=<sp/>STORMNODE_SYNC_THRESHOLD<sp/>*<sp/>3<sp/>||<sp/><ref refid="util_8cpp_1a46fac5fba8ba905b5f9acb364f5d8c6f" kindref="member">GetTime</ref>()<sp/>-<sp/><ref refid="class_c_stormnode_sync_1a2e7baab6709175db874ce9bc325c762d" kindref="member">nAssetSyncStarted</ref><sp/>&gt;<sp/>STORMNODE_SYNC_TIMEOUT<sp/>*<sp/>5))<sp/>{</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>maybe<sp/>there<sp/>is<sp/>no<sp/>budgets<sp/>at<sp/>all,<sp/>so<sp/>just<sp/>finish<sp/>syncing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a3c70130712267c3c100a69d35b97acf8" kindref="member">GetNextAsset</ref>();</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sandstorm_8cpp_1ac75d1761e37a1f1cbf71007bcbadf5b0" kindref="member">activeStormnode</ref>.<ref refid="class_c_active_stormnode_1a9532e0804ea4c96ad7d58ab3e9da6891" kindref="member">ManageStatus</ref>();</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="390"><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pnode-&gt;<ref refid="class_c_node_1ae94af0e82ca84242e420fc53debe6f25" kindref="member">HasFulfilledRequest</ref>(</highlight><highlight class="stringliteral">&quot;busync&quot;</highlight><highlight class="normal">))<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pnode-&gt;<ref refid="class_c_node_1a5b378bdd447e2f1e63ced2ae5b36ed76" kindref="member">FulfilledRequest</ref>(</highlight><highlight class="stringliteral">&quot;busync&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="393"><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref><sp/>&gt;=<sp/>STORMNODE_SYNC_THRESHOLD<sp/>*<sp/>3)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="395"><highlight class="normal"></highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classuint256" kindref="compound">uint256</ref><sp/>n<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pnode-&gt;<ref refid="class_c_node_1a204fda3d33404cb37698c085b1583ab2" kindref="member">PushMessage</ref>(</highlight><highlight class="stringliteral">&quot;snvs&quot;</highlight><highlight class="normal">,<sp/>n);<sp/></highlight><highlight class="comment">//sync<sp/>stormnode<sp/>votes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_c_stormnode_sync_1a66dcbc68478f042210ec161a7aba7fd5" kindref="member">RequestedStormnodeAttempt</ref>++;</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="402"><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="405"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/home/dev/ds-160209/src/stormnode-sync.cpp"/>
  </compounddef>
</doxygen>
